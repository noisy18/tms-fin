{% extends 'users/security/security-layout.html' %}
{% load static %}

{% block title %}Task Manage System - –ó–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å{% endblock %}

{% block style %}
    {{ super }}
    <link rel="stylesheet" href="{% static 'users/css/additional-styles/calendar-container.css' %}">
    <link rel="stylesheet" href="{% static 'users/css/page-styles/security/tasks-list.css' %}">
    <link rel="stylesheet" href="{% static 'users/css/additional-styles/tasks-styles.css' %}">
{% endblock %}

{% block main-content %}
    <main>
        <div class="right-content">
            <h1>–ó–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å</h1>
            <div class="date">
                <p id="currentDateTime"></p>
            </div>

            <div class="parent-element">
                <button class="calendar-btn" id="calendar-button">üóìÔ∏è –í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É</button>
                <div class="calendar-container" id="calendar-container">
                    <input type="date" id="date-picker" value="{{ current_date }}">
                </div>
            </div>

            {% for task in texttasks %}
                <div class="text-task">
                    <h3 class="heading">{{ task.title }}</h3>
                    <p class="text-left">{{ task.full_text }}</p>
                    <h3 class="text-right">–î–∞—Ç–∞: {{ task.date }}</h3>
                    <h3 class="text-right">–í—Ä–µ–º—è: {{ task.time }}</h3>
                    <h3 class="text-right">–ê–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏: {{ task.author.username }}</h3>

                    {% if task.date == today %}
                        <form action="{% url 'mark_text_task_complete' id=task.id %}" method="post">
                            {% csrf_token %}
                            <button class="exit-success-button">–ì–æ—Ç–æ–≤–æ</button>
                        </form>
                    {% endif %}
                </div>
            {% endfor %}
                    
            {% for task in entrytasks %}
                <div class="entry-task">
                    <h3 class="heading">–ú–∞—à–∏–Ω–∞ –Ω–∞ –≤—ä–µ–∑–¥</h3>
                    <h4 class="text-left" style="font-size: 24px;">–ì–æ—Å.–ù–æ–º–µ—Ä: {{ task.number_auto }}</h4>
                    <div class="status {% if task.is_allowed %}allowed{% else %}denied{% endif %}">
                        –í—ä–µ–∑–¥: {% if task.is_allowed %}–†–∞–∑—Ä–µ—à–µ–Ω{% else %}–ó–∞–ø—Ä–µ—â–µ–Ω{% endif %}
                    </div>
                    <h4 class="text-left">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ: <span>{{ task.marka_auto }}</span></h4>
                    <h4 class="text-left">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: <span>{{ task.name_organization }}</span></h4>
                    <h4 class="text-left">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: <span>{{ task.description }}</span></h4>
                    <h4 class="text-right">–í—Ä–µ–º—è –≤—ä–µ–∑–¥–∞: <span>{{ task.date }} {{ task.time }}</span></h4>
                    <h4 class="text-right">–ê–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏: {{ task.author.username }}</h4>

                    {% if task.date == today and task.is_allowed %}
                        <form action="{% url 'mark_entry_task_complete' id=task.id %}" method="post">
                            {% csrf_token %}
                            <button class="entry-success-button">–í—ä–µ—Ö–∞–ª–∞</button>
                        </form>
                    {% endif %}
                </div>
            {% endfor %}

            {% for task in exittasks %}
                <div class="exit-task">
                    <h3 class="heading">–ú–∞—à–∏–Ω–∞ –Ω–∞ –≤—ã–µ–∑–¥</h3>
                    <h4 class="text-left" style="font-size: 24px;">–ì–æ—Å.–ù–æ–º–µ—Ä: {{ task.number_auto }}</h4>
                    <div class="status {% if task.is_allowed %}allowed{% else %}denied{% endif %}">
                        –í—ã–µ–∑–¥: {% if task.is_allowed %}–†–∞–∑—Ä–µ—à–µ–Ω{% else %}–ó–∞–ø—Ä–µ—â–µ–Ω{% endif %}
                    </div>
                    <h4 class="text-left">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ: <span>{{ task.marka_auto }}</span></h4>
                    <h4 class="text-left">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: <span>{{ task.name_organization }}</span></h4>
                    <h4 class="text-left">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: <span>{{ task.description }}</span></h4>
                    <h4 class="text-right">–í—Ä–µ–º—è –≤—ã–µ–∑–¥–∞: <span>{{ task.date }} {{ task.time }}</span></h4>
                    <h4 class="text-right">–ê–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏: {{ task.author.username }}</h4>

                    {% if task.date == today and task.is_allowed %}
                        <form action="{% url 'mark_exit_task_complete' id=task.id %}" method="post">
                            {% csrf_token %}
                            <button class="exit-success-button">–í—ã–µ—Ö–∞–ª–∞</button>
                        </form>
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    </main>

<!-- SCRIPTS -->
<script src="{% static 'users/js/current-date.js' %}"></script>
<script src="{% static 'users/js/calendar-container.js' %}"></script>
{% endblock %}