{% extends 'tms_admin/admin-layout.html' %}
{% load static %}

{% block title %}Task Manage System - –ó–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å{% endblock %}

{% block style %}
    {{ super }}
    <link rel="stylesheet" href="{% static 'tms_admin/css/additional-styles/page-buttons.css' %}">
    <link rel="stylesheet" href="{% static 'tms_admin/css/additional-styles/calendar-container.css' %}">
    <link rel="stylesheet" href="{% static 'tms_admin/css/additional-styles/tasks-styles.css' %}">
    <link rel="stylesheet" href="{% static 'tms_admin/css/page-styles/tasks-list.css' %}">
{% endblock %}

{% block main-content %}
<main>
    <div class="right-content">
        <h1>–ó–∞–¥–∞—á–∏ –Ω–∞ –¥–µ–Ω—å</h1>
        <div class="date">
            <p id="currentDateTime"></p>
        </div>

        <div class="buttons">
            <div class="select-task-type">
                <button class="add-task page-btn">üìù –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>
                <div class="droplist" id="dropdownList">
                    <form action="{% url 'add_text_task' %}" method="get">
                        <button>–¢–µ–∫—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞</button>
                    </form>
                    
                    <form action="{% url 'add_entry_task' %}" method="get">
                        <button>–ú–∞—à–∏–Ω–∞ –Ω–∞ –≤—ä–µ–∑–¥</button>
                    </form>
                    
                    <form action="{% url 'add_exit_task' %}" method="get">
                        <button>–ú–∞—à–∏–Ω–∞ –Ω–∞ –≤—ã–µ–∑–¥</button>
                    </form>
                </div>
            </div>

            <div class="parent-element" style="margin-top: 0px;">
                <button class="calendar-btn" id="calendar-button">üóìÔ∏è –í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É</button>
                <div class="calendar-container" id="calendar-container">
                    <input type="date" id="date-picker" value="{{ current_date }}">
                </div>
            </div>
            
            <div class="end-btn">
                <form action="{% url 'completed_tasks' %}" method="get">
                    <button class="end-tasks page-btn">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Å–µ–≥–æ–¥–Ω—è</button>
                </form>
            </div>
        </div>

        {% for task in texttasks %}
            <div class="text-task">
                <h3 class="heading">{{ task.title }}</h3>
                <p class="text-left">{{ task.full_text }}</p>
                <h3 class="text-right">–î–∞—Ç–∞: {{ task.date }}</h3>
                <h3 class="text-right">–í—Ä–µ–º—è: {{ task.time }}</h3>
                <h3 class="text-right">–ê–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏: {{ task.author.username }}</h3>
                
                <form action="{% url 'edit_text_task' id=task.id %}" method="get">
                    <button class="edit-button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </form>

                <form action="{% url 'mark_text_task_complete' id=task.id %}" method="post">
                    {% csrf_token %}
                    <button class="exit-success-button">–ì–æ—Ç–æ–≤–æ</button>
                </form>
            </div>
        {% endfor %}
                
        {% for task in entrytasks %}
            <div class="entry-task">
                <h3 class="heading">–ú–∞—à–∏–Ω–∞ –Ω–∞ –≤—ä–µ–∑–¥</h3>
                <h4 class="text-left">–ì–æ—Å.–ù–æ–º–µ—Ä: <span>{{ task.number_auto }}</span></h4>
                <div class="status {% if task.is_allowed %}allowed{% else %}denied{% endif %}">
                    –í—ä–µ–∑–¥: {% if task.is_allowed %}–†–∞–∑—Ä–µ—à–µ–Ω{% else %}–ó–∞–ø—Ä–µ—â–µ–Ω{% endif %}
                </div>
                <h4 class="text-left">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ: <span>{{ task.marka_auto }}</span></h4>
                <h4 class="text-left">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: <span>{{ task.name_organization }}</span></h4>
                <h4 class="text-left">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: <span>{{ task.description }}</span></h4>
                <h4 class="text-right">–í—Ä–µ–º—è –≤—ä–µ–∑–¥–∞: <span>{{ task.date }} {{ task.time }}</span></h4>
                <h4 class="text-right">–ê–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏: {{ task.author.username }}</h4>

                <form action="{% url 'edit_entry_task' id=task.id %}" method="get">
                    <button class="edit-entry-button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </form>

                <form action="{% url 'mark_entry_task_complete' id=task.id %}" method="post">
                    {% csrf_token %}
                    <button class="entry-success-button">–í—ä–µ—Ö–∞–ª–∞</button>
                </form>
            </div>
        {% endfor %}

        {% for task in exittasks %}
            <div class="exit-task">
                <h3 class="heading">–ú–∞—à–∏–Ω–∞ –Ω–∞ –≤—ã–µ–∑–¥</h3>
                <h4 class="text-left">–ì–æ—Å.–ù–æ–º–µ—Ä: <span>{{ task.number_auto }}</span></h4>
                <div class="status {% if task.is_allowed %}allowed{% else %}denied{% endif %}">
                    –í—ã–µ–∑–¥: {% if task.is_allowed %}–†–∞–∑—Ä–µ—à–µ–Ω{% else %}–ó–∞–ø—Ä–µ—â–µ–Ω{% endif %}
                </div>
                <h4 class="text-left">–ú–∞—Ä–∫–∞ –∞–≤—Ç–æ: <span>{{ task.marka_auto }}</span></h4>
                <h4 class="text-left">–ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏: <span>{{ task.name_organization }}</span></h4>
                <h4 class="text-left">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: <span>{{ task.description }}</span></h4>
                <h4 class="text-right">–í—Ä–µ–º—è –≤—ã–µ–∑–¥–∞: <span>{{ task.date }} {{ task.time }}</span></h4>
                <h4 class="text-right">–ê–≤—Ç–æ—Ä –∑–∞–¥–∞—á–∏: {{ task.author.username }}</h4>

                <form action="{% url 'edit_exit_task' id=task.id %}" method="get">
                    <button class="edit-exit-button">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </form>

                <form action="{% url 'mark_exit_task_complete' id=task.id %}" method="post">
                    {% csrf_token %}
                    <button class="exit-success-button">–í—ã–µ—Ö–∞–ª–∞</button>
                </form>
            </div>
        {% endfor %}
    </div>
</main>

<!-- SCRIPTS -->
<script src="{% static 'tms_admin/js/current-date.js' %}"></script>
<script src="{% static 'tms_admin/js/calendar-container.js' %}"></script>
<script src="{% static 'tms_admin/js/drop-list.js' %}"></script>
{% endblock %}